{"title":"Regression Model for What predicts strong teaching- Survey Questions","markdown":{"yaml":{"title":"Regression Model for What predicts strong teaching- Survey Questions","output":{"html_document":{"theme":"cerulean","code_folding":"hide","toc":true,"toc_float":true}}},"headingText":"| echo: true","containsRefs":false,"markdown":"\n\n\n```{r, include=FALSE}\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(pander)\nlibrary(readxl)\nlibrary(ggplot2movies)\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(tidyr)\nlibrary(naniar) #replace to na\nlibrary(DT)\nlibrary(arrow)\n\nself <-  read_excel(\"/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/Self_Evaluation.xlsx\")\nemployer <- read_excel(\"/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/Employer_Evaluation.xlsx\")\ndem <- read_parquet('/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/demographics.parquet') \n```\n\n\n## Model is average qsuvery question score\n\n### **Self Survey**\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n# 5 to. NA\nself <- self %>% \n  replace_with_na_all(condition = ~.x == 5)\n\nemployer <- employer %>%\n  replace_with_na_all(condition = ~.x == 5)\n\nself <- self %>%\n  mutate(who = \"Individual\") %>%\n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Maintain Accurate Records`), na.rm = TRUE), 2))\n\n   \nemployer <- employer %>% \n  filter(`Enable Student to Learn` < 5) %>% \n  mutate(who=\"Principal\") %>% \n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Maintain Accurate Records`), na.rm = TRUE), 2)) \n\n###Join data\n\nself_dem <- inner_join(self, dem, by = \"StudentID\") %>%\n  distinct(StudentID, .keep_all = TRUE)\nself_dem <-  self_dem[!is.na(self_dem$`Avg Score`), ]\n#self_dem$Gender <- as.factor(self_dem$Gender)\n\nemployer_dem <- inner_join(employer, dem, by = \"StudentID\") %>% \n  distinct(StudentID, .keep_all = TRUE)\nemployer_dem <-  employer_dem[!is.na(employer_dem$`Avg Score`), ]\n\n```\n\n#### CurrentCumGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n#self\n#CurrentCumGPA\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand Current Cum GPA\")\nabline( self.lm , lwd = 2,col=\"red\")\n```\n\n##### Gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n##gender\n#not significant linear \n\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA + #CurrentCumGPA p= 0.0265\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Gender\")\nabline(2.32606 ,  0.17704, lwd = 3,col=palette()[1])\nabline(2.32606+ 0.38469 ,0.17704-0.09668, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n\n##### Ethnicity\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA +\n                as.factor(Ethnicity),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"skyblue4\",\"firebrick\",\"skyblue\",\"sienna1\",\"gray\",\"sienna4\",\"lightgreen\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem, pch=16, col =as.numeric(factor(Ethnicity)),main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Ethnicity\")\nabline(self.lm$coef[1]               , self.lm$coef[2], col=palette()[1])\nabline(self.lm$coef[1]+self.lm$coef[3], self.lm$coef[2]+self.lm$coef[3], col=palette()[2])\nabline(self.lm$coef[1]+self.lm$coef[4], self.lm$coef[2]+self.lm$coef[4], col=palette()[3])\nabline(self.lm$coef[1]+self.lm$coef[5], self.lm$coef[2]+self.lm$coef[5], col=palette()[4])\nabline(self.lm$coef[1]+self.lm$coef[6], self.lm$coef[2]+self.lm$coef[6], col=palette()[5])\nabline(self.lm$coef[1]+self.lm$coef[7], self.lm$coef[2]+self.lm$coef[7], col=palette()[6])\nabline(self.lm$coef[1]+self.lm$coef[8], self.lm$coef[2]+self.lm$coef[8], col=palette()[7])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"Asian\",\"Black\",\"Hawaiian, Pacific Island\",\"Hispanic, Latino\",\"Other\",\"Unknown\", \"White\"), bty=\"n\", text.col = palette(),  cex = 0.5)\n\n\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  ACTComposite, #p=0.543  \n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite, data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand ACT Composite\")\nabline(self.lm, lwd = 2,col=\"red\")\n```\n\n##### Gender\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#gender\nemp.lm <- lm(`Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite by Gender\")\nabline(  3.176932 , -0.003915 , lwd = 3,col=palette()[1])\nabline( 3.176932-0.209335 , -0.003915+0.017143  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#HighSchoolGPA\nself.lm <- lm(`Avg Score` ~  HighSchoolGPA, #p=0.156 \n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA, data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand HighSchool GPA\")\nabline(self.lm, lwd = 2,col=\"red\")\n\n```\n\n##### Gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=self_dem, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and HighSchool GPA\\nby Gender\")\nabline(  2.80650 ,  0.04262, lwd = 3,col=palette()[1])\nabline(  2.80650-1.38675  , 0.04262+0.42763  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n### **Employer Survey**\n\n#### CurrentCumGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#CurrentCumGPA\nemp.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n              data = employer_dem )\nsummary(emp.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem ,pch=16,main=\"Employer Survey Aveage Socres \\nand Current Cum GPA\")\nabline(  2.63882 , 0.13435 , lwd = 2,col=\"red\")\n\n```\n\n##### Gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n##gender\n#not significant linear \n\nemp.lm <- lm(`Avg Score` ~  CurrentCumGPA +\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nCurrent Cum GPA by Gender\")\nabline(2.67608 ,  0.11978, lwd = 3,col=palette()[1])\nabline(2.67608-0.45129 ,0.11978+0.16188, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#ACTComposite\n#not significant linear \nemp.lm <- lm(`Avg Score` ~   ACTComposite,\n             data = employer_dem )\nsummary(emp.lm)\n\nplot(`Avg Score` ~ ACTComposite , data=employer_dem ,pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite\")\nabline(  3.188623 , -0.003268 , lwd = 2,col=\"red\")\n```\n\n##### Gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nemp.lm <- lm(`Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite by Gender\")\nabline(  3.176932 , -0.003915 , lwd = 3,col=palette()[1])\nabline( 3.176932-0.209335 , -0.003915+0.017143  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#HighSchoolGPA\nemp.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nby Gender\")\nabline(  2.98260  ,  0.03281 , lwd = 3,col=palette()[1])\nabline(   2.98260-0.86284 , 0.03281+ 0.29697  , lwd = 3, col=palette()[2])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n##### Gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n\nemp.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand HighSchool GPA by Gender\")\nabline(  2.98260  ,  0.03281 , lwd = 3,col=palette()[1])\nabline(   2.98260-0.86284 , 0.03281+ 0.29697  , lwd = 3, col=palette()[2])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n```\n\n## Model is drop question weight average is 0\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n\nself_dropq <- self %>%\n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Positive Effect on Student Achievement`), na.rm = TRUE), 2))\n\n\nemployer_dropq <- employer %>% \n  filter(`Enable Student to Learn` < 5) %>% \n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Positive Effect on Student Achievement`), na.rm = TRUE), 2)) \n\n\ndrop_self <- self %>% \n  select(StudentID:`Positive Effect on Student Achievement`, `Avg Score`) %>%\n  pivot_longer(`Enable Student to Learn`:`Positive Effect on Student Achievement`) %>%\n  mutate(weights = case_when(\n    name == \"Enable Student to Learn\" ~ 5,\n    name == \"Promote Active Student Learning\" ~ 5,\n    name == \"Plan Instruction\" ~ 5,\n    name == \"Determine Student Strengths\" ~ 10,\n    name == \"Meet Student Needs\" ~ 5,\n    name == \"Evaluate and Modify Teaching Plan\" ~ 5,\n    name == \"Encourage Diverse Perspectives\" ~ 5,\n    name == \"Support New English Learners\" ~ 5,\n    name == \"Help Student Assess Learning\" ~ 5,\n    name == \"Teach Students with Exceptional Needs\" ~ 5,\n    name == \"Honor Diverse Cultures\" ~ 5,\n    name == \"Positive Effect on Student Achievement\" ~ 10)) \n\ndrop_employer <- employer %>% \n  select(StudentID:`Positive Effect on Student Achievement`, `Avg Score`) %>%\n  pivot_longer(`Enable Student to Learn`:`Positive Effect on Student Achievement`) %>%\n  mutate(weights = case_when(\n    name == \"Enable Student to Learn\" ~ 5,\n    name == \"Promote Active Student Learning\" ~ 5,\n    name == \"Plan Instruction\" ~ 5,\n    name == \"Determine Student Strengths\" ~ 10,\n    name == \"Meet Student Needs\" ~ 5,\n    name == \"Evaluate and Modify Teaching Plan\" ~ 5,\n    name == \"Encourage Diverse Perspectives\" ~ 5,\n    name == \"Support New English Learners\" ~ 5,\n    name == \"Help Student Assess Learning\" ~ 5,\n    name == \"Teach Students with Exceptional Needs\" ~ 5,\n    name == \"Honor Diverse Cultures\" ~ 5,\n    name == \"Positive Effect on Student Achievement\" ~ 10)) \n\n\nself_dem_drop <- inner_join(self_dropq, dem, by = \"StudentID\") %>%\n  distinct(StudentID, .keep_all = TRUE)\nself_dem_drop <-  self_dem_drop[!is.na(self_dem_drop$`Avg Score`), ]\n#self_dem$Gender <- as.factor(self_dem$Gender)\n\nemployer_dem_drop <- inner_join(employer_dropq, dem, by = \"StudentID\") %>% \n  distinct(StudentID, .keep_all = TRUE)\nemployer_dem_drop <-  employer_dem_drop[!is.na(employer_dem_drop$`Avg Score`), ]\n\n```\n\n### **Self Survey**\n\n#### CurrentCumGPA\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n#CurrentCumGPA\nself0.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n              data = self_dem_drop )\nsummary(self0.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem_drop ,pch=16,main=\"Aveage Student Survey Socres \\nand Current Cum GPA\")\nabline( self0.lm , lwd = 2,col=\"red\")\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n#not significant linear \nself0.lm <- lm(`Avg Score` ~  CurrentCumGPA + #CurrentCumGPA p= 0.0265\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = self_dem_drop)\nsummary(self0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem_drop, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Gender\")\nabline(2.3404, 0.1571, lwd = 3,col=palette()[1])\nabline(2.3404+0.4062,0.1571-0.1042, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n#ACTComposite\n#not significant linear\nself0.lm <- lm(`Avg Score` ~  ACTComposite, #p=0.543  \n              data = self_dem_drop)\nsummary(self0.lm)\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nplot(`Avg Score` ~ ACTComposite, data=self_dem_drop,pch=16,main=\"Aveage Student Survey Socres \\nand ACT Composite\")\nabline(self_dem_drop, lwd = 2,col=\"red\")\n\n\n#not significant linear \n#gender\nself0.lm <- lm(`Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = self_dem_drop)\nsummary(self0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=self_dem_drop, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nACT Composite by Gender\")\nabline( 2.800517 , 0.004994, lwd = 3,col=palette()[1])\nabline( 2.800517+0.038578,0.004994-0.003115, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n#HighSchoolGPA\nself0.lm <- lm(`Avg Score` ~  HighSchoolGPA, #p=0.156 \n              data = self_dem_drop)\nsummary(self0.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA, data=self_dem_drop,pch=16,main=\"Aveage Student Survey Socres \\nand HighSchool GPA\")\nabline(self0.lm, lwd = 2,col=\"red\")\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nself0.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = self_dem_drop)\nsummary(self0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=self_dem_drop, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nHighSchool GPA by Gender\")\nabline( 2.85551, 0.01378, lwd = 3,col=palette()[1])\nabline(2.85551-1.26325,0.01378+0.38877 , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n```\n\n\n\n### **Employer Survey**\n\n#### CurrentCumGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nemp0.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n             data = employer_dem_drop )\nsummary(emp0.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem_drop ,pch=16,main=\"Employer Survey Aveage Socres \\nand Current Cum GPA\")\nabline(2.63305, 0.12738, lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nemp0.lm <- lm(`Avg Score` ~  CurrentCumGPA +\n               as.factor(Gender)+\n               CurrentCumGPA: as.factor(Gender),\n             data = employer_dem_drop )\nsummary(emp0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem_drop, col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nCurrent Cum GPA by Gender\")\nabline(2.64946,0.11863, lwd = 3,col=palette()[1])\nabline(2.64946-0.36809,0.11863+0.13733, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\nemp0.lm <- lm(`Avg Score` ~   ACTComposite,\n             data = employer_dem_drop)\nsummary(emp0.lm)\n\nplot(`Avg Score` ~ ACTComposite , data=employer_dem_drop,pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite\")\nabline(3.173841,-0.004074, lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nemp0.lm <- lm(`Avg Score` ~  ACTComposite + \n               as.factor(Gender)+\n               ACTComposite:as.factor(Gender),\n             data = employer_dem_drop)\nsummary(emp0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=employer_dem_drop, col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite by Gender\")\nabline(  3.156878, -0.004526, lwd = 3,col=palette()[1])\nabline(3.156878-0.179428, -0.004526+0.016019, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nemp0.lm <- lm(`Avg Score` ~   HighSchoolGPA,\n             data = employer_dem_drop)\nsummary(emp0.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=employer_dem_drop,pch=16,main=\"Employer Survey Aveage Socres \\nand HighSchool GPA \")\nabline(2.85850, 0.06439, lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nemp0.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n               as.factor(Gender)+\n               HighSchoolGPA:as.factor(Gender),\n             data = employer_dem_drop)\nsummary(emp0.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=employer_dem_drop, col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand HighSchool GPA by Gender\")\nabline(2.98943,0.02214 , lwd = 3,col=palette()[1])\nabline(2.98943-0.87330,0.02214+0.30051, lwd = 3, col=palette()[2])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n```\n\n\n## Model is weighted average\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n## weight avg \n\n\n### Multiple Linear Regression Model\nself_dem <- inner_join(self, dem, by = \"StudentID\") %>%\n  distinct(StudentID, .keep_all = TRUE)\nself_dem <-  self_dem[!is.na(self_dem$`Avg Score`), ]\n#self_dem$Gender <- as.factor(self_dem$Gender)\n\nemployer_dem <- inner_join(employer, dem, by = \"StudentID\") %>% \n  distinct(StudentID, .keep_all = TRUE)\nemployer_dem <-  employer_dem[!is.na(employer_dem$`Avg Score`), ]\n\n\nweight_self <- self_dem%>%\n  mutate(\n    `Enable Student to Learn Weight`  = `Enable Student to Learn` * 5,\n    `Promote Active Student Learning Weight` = `Promote Active Student Learning` * 5,\n    `Plan Instruction Weight` = `Plan Instruction`* 5,\n    `Determine Student Strengths Weight` = `Determine Student Strengths`* 10,\n    `Meet Student Needs Weight` = `Meet Student Needs`* 5,\n    `Evaluate and Modify Teaching Plan Weight` = `Evaluate and Modify Teaching Plan`* 5,\n    `Encourage Diverse Perspectives Weight` = `Encourage Diverse Perspectives`* 5,\n    `Support New English Learners Weight` = `Support New English Learners`* 5,\n    `Help Student Assess Learning Weight` = `Help Student Assess Learning`* 5,\n    `Teach Students with Exceptional Needs Weight` = `Teach Students with Exceptional Needs`* 5,\n    `Honor Diverse Cultures Weight` = `Honor Diverse Cultures`* 5,\n    `Positive Effect on Student Achievement Weight` = `Positive Effect on Student Achievement`* 10,\n    `Use Technology Weight` = `Use Technology`* 0,\n    `Teamwork Weight` = `Teamwork`* 0,\n    `Self-reflection Weight` = `Self-reflection`* 0,\n    `Maintain Accurate Records Weight` = `Maintain Accurate Records`* 0) %>% \n  mutate(`Weight Avg Score` = round(rowMeans(select(., `Enable Student to Learn Weight`: `Maintain Accurate Records Weight`), na.rm = TRUE), 2))\n\n\n\nweight_emp <- employer_dem%>%\n  mutate(\n    `Enable Student to Learn Weight`  = `Enable Student to Learn` * 5,\n    `Promote Active Student Learning Weight` = `Promote Active Student Learning` * 5,\n    `Plan Instruction Weight` = `Plan Instruction`* 5,\n    `Determine Student Strengths Weight` = `Determine Student Strengths`* 10,\n    `Meet Student Needs Weight` = `Meet Student Needs`* 5,\n    `Evaluate and Modify Teaching Plan Weight` = `Evaluate and Modify Teaching Plan`* 5,\n    `Encourage Diverse Perspectives Weight` = `Encourage Diverse Perspectives`* 5,\n    `Support New English Learners Weight` = `Support New English Learners`* 5,\n    `Help Student Assess Learning Weight` = `Help Student Assess Learning`* 5,\n    `Teach Students with Exceptional Needs Weight` = `Teach Students with Exceptional Needs`* 5,\n    `Honor Diverse Cultures Weight` = `Honor Diverse Cultures`* 5,\n    `Positive Effect on Student Achievement Weight` = `Positive Effect on Student Achievement`* 10,\n    `Use Technology Weight` = `Use Technology`* 0,\n    `Teamwork Weight` = `Teamwork`* 0,\n    `Self-reflection Weight` = `Self-reflection`* 0,\n    `Maintain Accurate Records Weight` = `Maintain Accurate Records`* 0) %>% \n  mutate(`Weight Avg Score` = round(rowMeans(select(., `Enable Student to Learn Weight`: `Maintain Accurate Records Weight`), na.rm = TRUE), 2))\n\n```\n\n### **Self Survey**\n\n#### CurrentCumGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nselfw.lm <- lm(`Weight Avg Score` ~  CurrentCumGPA,\n              data = weight_self)\nsummary(selfw.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ CurrentCumGPA , data=weight_self,pch=16,main=\"Aveage Student Survey Socres \\nand Current Cum GPA\")\nabline( selfw.lm , lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nselfw.lm <- lm(`Weight Avg Score` ~  CurrentCumGPA + #CurrentCumGPA p= 0.0265\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = weight_self)\nsummary(selfw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ CurrentCumGPA , data=weight_self, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Gender\")\nabline(10.0432 ,  0.7421, lwd = 3,col=palette()[1])\nabline(10.0432+1.8896,0.7421-0.4911, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n#ACTComposite\n#not significant linear\nselfw.lm <- lm(`Weight Avg Score` ~  ACTComposite, #p=0.543  \n              data = weight_self)\nsummary(selfw.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ ACTComposite, data=weight_self,pch=16,main=\"Aveage Student Survey Socres \\nand ACT Composite\")\nabline(selfw.lm, lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n#not significant linear \n#gender\nselfw.lm <- lm(`Weight Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = weight_self)\nsummary(selfw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ ACTComposite , data=weight_self, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and CACT Composite\\nby Gender\")\nabline( 12.46303,0.01335, lwd = 3,col=palette()[1])\nabline(12.46303-0.47871,0.01335+0.01392, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n#HighSchoolGPA\nselfw.lm <- lm(`Weight Avg Score` ~  HighSchoolGPA, #p=0.156 \n              data = weight_self)\nsummary(selfw.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ HighSchoolGPA, data=weight_self ,pch=16,main=\"Aveage Student Survey Socres \\nand HighSchool GPA\")\nabline(selfw.lm, lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nselfw.lm <- lm(`Weight Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = weight_self)\nsummary(selfw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ HighSchoolGPA , data=weight_self, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and HighSchool GPA\\nby Gender\")\nabline(12.49820,0.05896, lwd = 3,col=palette()[1])\nabline(12.49820-5.63024,0.05896+1.71930, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n\n```\n\n\n### **Employer Survey**\n\n#### CurrentCumGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nempw.lm <- lm(`Weight Avg Score` ~  CurrentCumGPA,\n             data = weight_emp)\nsummary(empw.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ CurrentCumGPA , data=weight_emp,pch=16,main=\"Employer Survey Aveage Socres \\nand Current Cum GPA\")\nabline(11.4750, 0.5330, lwd = 2,col=\"red\")\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\n##gender\n#not significant linear \n\nempw.lm <- lm(`Weight Avg Score` ~  CurrentCumGPA +\n               as.factor(Gender)+\n               CurrentCumGPA: as.factor(Gender),\n             data = weight_emp )\nsummary(empw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ CurrentCumGPA , data=weight_emp, col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nCurrent Cum GPA\\nby Gender\")\nabline(11.6810  ,0.4586, lwd = 3,col=palette()[1])\nabline(11.6810-2.0519 ,0.4586+0.7222, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n\n```\n\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nempw.lm <- lm(`Weight Avg Score` ~   ACTComposite,\n             data = weight_emp )\nsummary(empw.lm)\n\nplot(`Weight Avg Score` ~ ACTComposite , data=weight_emp ,pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite\")\nabline(13.530010, -0.008085, lwd = 2,col=\"red\")\n\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nempw.lm <- lm(`Weight Avg Score` ~  ACTComposite + \n               as.factor(Gender)+\n               ACTComposite:as.factor(Gender),\n             data = weight_emp )\nsummary(empw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ ACTComposite , data=weight_emp , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand ACT Composite by Gender\")\nabline(13.46356, -0.01005, lwd = 3,col=palette()[1])\nabline( 13.46356-0.75443, -0.01005+0.06642, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nempw.lm <- lm(`Weight Avg Score` ~   HighSchoolGPA,\n             data = weight_emp)\nsummary(empw.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ HighSchoolGPA , data=weight_emp ,pch=16,main=\"Employer Survey Aveage Socres \\nand HighSchool GPA \")\nabline( 12.2714,0.3105  , lwd = 2,col=\"red\")\n\n```\n\n##### gender\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n\nempw.lm <- lm(`Weight Avg Score` ~  HighSchoolGPA+\n               as.factor(Gender)+\n               HighSchoolGPA:as.factor(Gender),\n             data = weight_emp)\nsummary(empw.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Weight Avg Score` ~ HighSchoolGPA , data=weight_emp, col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nand HighSchool GPA by Gender\")\nabline(13.11740,0.05199, lwd = 3,col=palette()[1])\nabline(13.11740-4.63278,0.05199+1.53586, lwd = 3, col=palette()[2])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"html_document":{"theme":"cerulean","code_folding":"hide","toc":true,"toc_float":true}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"regression.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.280","theme":"cosmo","title":"Regression Model for What predicts strong teaching- Survey Questions"},"extensions":{"book":{"multiFile":true}}}}}