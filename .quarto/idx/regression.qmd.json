{"title":"Regression Model for What predicts strong teaching- Survey Questions","markdown":{"yaml":{"title":"Regression Model for What predicts strong teaching- Survey Questions","output":{"html_document":{"theme":"cerulean","echo":true,"code-fold":true}}},"headingText":"| echo: true","containsRefs":false,"markdown":"\n\n```{r, include=FALSE}\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(pander)\nlibrary(readxl)\nlibrary(ggplot2movies)\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(tidyr)\nlibrary(naniar) #replace to na\nlibrary(DT)\nlibrary(arrow)\n\nself <-  read_excel(\"/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/Self_Evaluation.xlsx\")\nemployer <- read_excel(\"/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/Employer_Evaluation.xlsx\")\ndem <- read_parquet('/Users/tanglin/Library/CloudStorage/OneDrive-BYU-Idaho/kelinseniorproject/new_project/demographics.parquet') \n```\n\n### Self Survey\n#### CurrentCumGPA\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n# 5 to. NA\nself <- self %>% \n  replace_with_na_all(condition = ~.x == 5)\n\nemployer <- employer %>%\n  replace_with_na_all(condition = ~.x == 5)\n\nself <- self %>%\n  mutate(who = \"Individual\") %>%\n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Maintain Accurate Records`), na.rm = TRUE), 2))\n\n   \nemployer <- employer %>% \n  filter(`Enable Student to Learn` < 5) %>% \n  mutate(who=\"Principal\") %>% \n  mutate(`Avg Score` = round(rowMeans(select(., `Enable Student to Learn`: `Maintain Accurate Records`), na.rm = TRUE), 2)) \n\n###Join data\nbothsur <- inner_join(self, employer, by = \"StudentID\")\n\nbind <- bind_rows(self,employer)\n\n```\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself_dem <- inner_join(self, dem, by = \"StudentID\") %>%\n  distinct(StudentID, .keep_all = TRUE)\nself_dem <-  self_dem[!is.na(self_dem$`Avg Score`), ]\n#self_dem$Gender <- as.factor(self_dem$Gender)\n\nemployer_dem <- inner_join(employer, dem, by = \"StudentID\") %>% \n  distinct(StudentID, .keep_all = TRUE)\nemployer_dem <-  employer_dem[!is.na(employer_dem$`Avg Score`), ]\n```\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n#self\n#CurrentCumGPA\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand Current Cum GPA\")\nabline( self.lm , lwd = 2,col=\"red\")\n```\n\n##### Gender\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n##gender\n#not significant linear \n\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA + #CurrentCumGPA p= 0.0265\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Gender\")\nabline(2.32606 ,  0.17704, lwd = 3,col=palette()[1])\nabline(2.32606+ 0.38469 ,0.17704-0.09668, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n\n##### Ethnicity\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  CurrentCumGPA +\n                as.factor(Ethnicity),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"skyblue4\",\"firebrick\",\"skyblue\",\"sienna1\",\"gray\",\"sienna4\",\"lightgreen\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=self_dem, pch=16, col =as.numeric(factor(Ethnicity)),main=\"Student Survey Aveage Socres and \\nCurrent Cum GPA by Ethnicity\")\nabline(self.lm$coef[1]               , self.lm$coef[2], col=palette()[1])\nabline(self.lm$coef[1]+self.lm$coef[3], self.lm$coef[2]+self.lm$coef[3], col=palette()[2])\nabline(self.lm$coef[1]+self.lm$coef[4], self.lm$coef[2]+self.lm$coef[4], col=palette()[3])\nabline(self.lm$coef[1]+self.lm$coef[5], self.lm$coef[2]+self.lm$coef[5], col=palette()[4])\nabline(self.lm$coef[1]+self.lm$coef[6], self.lm$coef[2]+self.lm$coef[6], col=palette()[5])\nabline(self.lm$coef[1]+self.lm$coef[7], self.lm$coef[2]+self.lm$coef[7], col=palette()[6])\nabline(self.lm$coef[1]+self.lm$coef[8], self.lm$coef[2]+self.lm$coef[8], col=palette()[7])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"Asian\",\"Black\",\"Hawaiian, Pacific Island\",\"Hispanic, Latino\",\"Other\",\"Unknown\", \"White\"), bty=\"n\", text.col = palette(), , cex = 0.5)\n\n\n```\n\n#### ACTComposite\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  ACTComposite, #p=0.543  \n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite, data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand ACT Composite\")\nabline(self.lm, lwd = 2,col=\"red\")\n```\n\n##### Gender\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#gender\nself.lm <- lm(`Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=self_dem, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and CACT Composite\\nby Gender\")\nabline( 2.847104 , 0.005511, lwd = 3,col=palette()[1])\nabline( 2.847104+0.015176 , 0.005511-0.001284  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#HighSchoolGPA\nself.lm <- lm(`Avg Score` ~  HighSchoolGPA, #p=0.156 \n              data = self_dem)\nsummary(self.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA, data=self_dem,pch=16,main=\"Aveage Student Survey Socres \\nand HighSchool GPA\")\nabline(self.lm, lwd = 2,col=\"red\")\n\n```\n\n##### Gender\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\nself.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = self_dem)\nsummary(self.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=self_dem, col=as.factor(Gender),pch=16,main=\"Student Survey Aveage Socres and HighSchool GPA\\nby Gender\")\nabline(  2.80650 ,  0.04262, lwd = 3,col=palette()[1])\nabline(  2.80650-1.38675  , 0.04262+0.42763  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n### Employer Survey\n\n#### CurrentCumGPA\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#CurrentCumGPA\nemp.lm <- lm(`Avg Score` ~  CurrentCumGPA,\n              data = employer_dem )\nsummary(emp.lm)\n\n#palette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem ,pch=16,main=\"Employer Survey Aveage Socres \\nand Current Cum GPA\")\nabline( 2.42882 , 0.13435 , lwd = 2)\n```\n\n##### Gender\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n##gender\n#not significant linear \n\nemp.lm <- lm(`Avg Score` ~  CurrentCumGPA +\n                as.factor(Gender)+\n                CurrentCumGPA: as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ CurrentCumGPA , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nCurrent Cum GPA\\nby Gender\")\nabline(2.32606 ,  0.17704, lwd = 3,col=palette()[1])\nabline(2.32606-0.45129 ,0.17704+0.16188, lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### ACTComposite\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#ACTComposite\n#not significant linear \n\nemp.lm <- lm(`Avg Score` ~  ACTComposite + \n                as.factor(Gender)+\n                ACTComposite:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ ACTComposite , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nby Gender\")\nabline(  3.176932 , -0.003915 , lwd = 3,col=palette()[1])\nabline( 3.176932-0.209335 , -0.003915+0.017143  , lwd = 3, col=palette()[2])\nlegend(\"bottomright\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```\n\n#### HighSchoolGPA\n\n```{r}\n#| echo: true\n#| code-fold: true\n#| #| code-summary: \"expand for full code\"\n### Multiple Linear Regression Model\n#HighSchoolGPA\nemp.lm <- lm(`Avg Score` ~  HighSchoolGPA+\n                as.factor(Gender)+\n                HighSchoolGPA:as.factor(Gender),\n              data = employer_dem )\nsummary(emp.lm)\n\npalette(c(\"lightblue\",\"orange\"))\nplot(`Avg Score` ~ HighSchoolGPA , data=employer_dem , col=as.factor(Gender),pch=16,main=\"Employer Survey Aveage Socres \\nby Gender\")\nabline(  2.98260  ,  0.03281 , lwd = 3,col=palette()[1])\nabline(   2.98260-0.86284 , 0.03281+ 0.29697  , lwd = 3, col=palette()[2])\nlegend(\"bottomleft\", col=palette(), pch=21, legend=c(\"F\", \"M\"), bty=\"n\", text.col = palette())\n```"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"html_document":{"theme":"cerulean","echo":true,"code-fold":true}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"regression.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.280","theme":"cosmo","title":"Regression Model for What predicts strong teaching- Survey Questions"},"extensions":{"book":{"multiFile":true}}}}}